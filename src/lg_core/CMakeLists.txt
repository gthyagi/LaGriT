cmake_minimum_required(VERSION 3.16)

# Configure the lagrit.h header file with CMake variables
string(TIMESTAMP CMAKE_DATE_COMPILE "%Y/%m/%d")
configure_file(
    "${CMAKE_CURRENT_SOURCE_DIR}/lagrit.h.in"
    "${CMAKE_CURRENT_BINARY_DIR}/lagrit.h"
    @ONLY)

if(LG_ENABLE_EXODUS)
    target_compile_definitions(lagrit
        PRIVATE
            LAGRIT_INCLUDE_EXODUSII)
endif()

# Set source files *exclusive* to executable
if(NOT LG_BUILD_AS_LIBRARY)
    target_sources(lagrit
        PRIVATE
            lagrit_main.f)
endif()

# Set all library source files
target_sources(lagrit
    PRIVATE
        ColoredGraphModule.f90
        GraphModule.f90
        LowPassFilterModule.f90
        addmesh.f
        addmesh_add.f
        addmesh_amr.f
        addmesh_append.f
        addmesh_delete.f
        addmesh_intersection.f
        addmesh_merge.f
        addmesh_overlap.f
        addmesh_pyramid.f
        addmesh_reflect.f
        agd3d.f
        angle3.f
        angle3c.f
        angle3v.f
        anothermatbld3d.c
        anothermatbld3d_wrapper.f
        aratio_element.f
        aratio_element_edge.f
        aratio_hex.f
        aratio_qud.f
        aratio_tet.f
        aratio_tri.f
        assign_quadrant_id.f
        beads_ona_ring.f
        bin_ij_edge.f
        bingrid.f
        blockcom.h
        bndpts.f
        boundary.f
        boundary_components.f
        bubble.f
        calc_rdist.f
        cee_chain.f
        cel.f
        cel_chain.f
        cel_chain_f.f
        cer_chain.f
        checkmbndry_lg.f
        chglocl.f
        chgnorm.f
        chkreg.f
        chkregliteral.f
        chkregv.f
        chydro.h
        cinterpolate_elem.f
        closed_surfaces.f
        cmerge.h
        cmo.h
        cmo_addatt.f
        cmo_addatt_cmo.f
        cmo_addatt_def.f
        cmo_allocate.f
        cmo_att_derive.f
        cmo_command.f
        cmo_compress.f
        cmo_copy.f
        cmo_copyatt.f
        cmo_create.f
        cmo_create_cmo.f
        cmo_create_dir.f
        cmo_delatt.f
        cmo_delatt_cmo.f
        cmo_delatt_def.f
        cmo_derive.f
        cmo_dump_cmo.f
        cmo_exist.f
        cmo_geometry.f
        cmo_get_attdef.f
        cmo_get_attinfo.f
        cmo_get_attparam.f
        cmo_get_attribute_name.f
        cmo_get_default_attparam.f
        cmo_get_index.f
        cmo_get_info.f
        cmo_get_intinfo.f
        cmo_get_length.f
        cmo_get_mesh_type.f
        cmo_get_name.f
        cmo_get_name_type.f
        cmo_get_num_io_att.f
        cmo_get_stdptrs.f
        cmo_interpolate.F
        cmo_length.f
        cmo_lg.h
        cmo_list.f
        cmo_memory.f
        cmo_minmax.f
        cmo_mm_error.f
        cmo_modatt.f
        cmo_modatt_cmo.f
        cmo_modatt_def.f
        cmo_move.f
        cmo_newlen.f
        cmo_node_elem_id.f
        cmo_readatt.f
        cmo_readdump_cmo.f
        cmo_readdump_cmo_old.f
        cmo_release.f
        cmo_report.f
        cmo_select.f
        cmo_set_attinfo.f
        cmo_set_attparam.f
        cmo_set_default.f
        cmo_set_info.f
        cmo_set_mesh_type.f
        cmo_set_name.f
        cmo_setatt.f
        cmo_status.f
        cmo_verify.f
        cmo_verify_cmo.f
        cmo_verify_def.f
        coefficient.f
        colormap.f90
        commands_lg.h
        compute.f
        conbld.f
        config.sh
        connect.f
        connect2d_lg.f
        conset.f
        constrainv.f
        consts.h
        contable.f
        control_command_lg.f
        coordsys.f
        copyatt_mpary_lg.f
        copypts.f
        copyrite.h
        correctpc.f
        coupling_coef_wrapper.f
        cr_add.f
        cr_copy.f
        create_graph.f
        createpts_lg.f
        crush_thin_tets.f
        csl.f
        cycle_lg.f
        damp_pt_by_value.f
        damp_pt_by_volume.f
        delaunay.f
        delaunay2d_lg.f
        delaunay_connect.f
        delaunay_connect2d_lg.f
        derefine.f
        diagnl.f
        diamond.f
        dict_assign.f
        dihangle_element.f
        dihangle_face.f
        distance_field.f
        distance_field_signed.f
        distance_lg.f
        distance_to_sheet_lg.f
        do_command.f
        do_extract.f
        doping.f
        dopmat.f
        dot_product_6_planes.f
        dotask.f
        dotaskx3d.f
        dump_fehm_geom.f
        dump_geometries_lg.f
        dump_globals_lg.f
        dump_interface_list.f
        dump_lagrit.f
        dump_material_list.f
        dump_multi_mat_con.f
        dump_outside_list.f
        dump_parent_list.f
        dump_pflo_stor.f
        dumpavs.f
        dumpchad.f
        dumpdatex.f
        dumpexodusII.f
        dumpfehm.f
        dumpflotran.f
        dumpgeofest.f
        dumpgmv_hybrid.f
        dumpinventor.f
        dumpstl.f
        dumptecplot_hybrid.f
        edgefun_lg.f
        edgelst.f
        edit.f
        elliptic2d.f
        eltlimc.f
        eorpt.f
        erradpt.f
        eset.f
        esug2d.f
        eullag3.f
        evaluate_sobolevnorm.f
        excavate.f
        excre_wrapper.c
        exita.f
        exo_init_ext.c
        exo_put_sets.c
        extract_interface.f
        extract_isosurface.f
        extract_line.f
        extract_network.f
        extract_plane.f
        extract_surfmesh.f
        extrude.f
        face.f
        fadpt.f
        field.f
        field_compose.f
        field_dumpmfe.f
        field_scale.f
        field_volavg.f
        filholes.f
        filter.f
        filter_elem_graph.f
        filterkd.f
        find2to2.f
        find2to3.f
        find3to2.f
        find4to4.f
        findface.f
        finishbasis.f
        fix_small_tets.f
        fix_small_triangles_lg.f
        flbound.f
        flimc.f
        flip1to0.f
        flip2to0.f
        flip2to2.f
        flip2to3.f
        flip3to2.f
        flip4to4.f
        flipbdyc.f
        flp2to0b.f
        flp2to3b.f
        flp2to3i.f
        flp3to2i.f
        flp4to4i.f
        fnd2to3b.f
        fnd2to3i.f
        fnd3to2i.f
        fnd4to4i.f
        fndface2.f
        forcedmove.f
        freemove.f
        fset.f
        geniee.f
        geo_help.f
        geom_lg.h
        geometry_create_lg.f
        geometry_release_lg.f
        get_elements_around_node.f
        get_elements_on_edge.f
        get_epsilon.f
        get_global.f
        get_info_i.f
        get_material_info.f
        get_material_number.f
        get_materials_around_node.f
        get_xcontab.f
        getbit.f
        getchain.f
        getdof.f
        getedges.f
        geteset.f
        getfset.f
        getgsynth.f
        getiedge.f
        getmpary.f
        getnodhyb.f
        getnoditet.f
        getnoditet1.f
        getnodjtet.f
        getnodnod.f
        getpset.f
        getptyp.f
        getreg.f
        getregv.f
        getregv1.f
        getsfact.F
        getuv.f
        getvoloff.f
        getxyz.f
        global_lg.h
        gradient.f
        grid2grid.f
        grid_to_grid.f
        helpdic.f
        hess3d.f
        hextotet_att.f
        hextotet_hybrid.f
        hmemadjb.f
        hmemphy.f
        identify_dot.f
        ifaceptv.f
        ifacereg.f
        ifacerfl.f
        initlagrit.F
        initnbr.f
        insertll.f
        inside_element.f
        inside_lg.f
        int_edge.f
        inter2.f
        inter3.f
        inter4.f
        interior_edge.f
        interp_lg.f
        interpolate_hessian.f
        intersect_cmo.f
        intersect_elements.f
        intradd.f
        intrp_element.f
        intrp_element_mat.f
        intrp_gtg.f
        iprecision_lg.f
        isosurface.f
        kdtree.f
        kdtree0.f
        kdtree_cmo.f
        kdtreeselect.f
        killcode.f
        lagrit.h
        lagrit_fdate.f
        laplace2d.f
        line_graph_nsort.cpp
        line_graph_sort.cpp
        linear_trans.f
        lineline.f
        lineseg_inter.f
        lineseglineseg.f
        linesegtri.f
        local_element.h
        logcom1.h
        loop_lg.f
        lower_d_lg.f
        lpfilter.f90
        ltripedge.f
        machine.h
        machine_header.h
        machine_m32.h
        machine_m64.h
        make_big_tet.f
        make_bigtri_lg.f
        make_face_vertex_list.f
        mask_icr.f
        massage.f
        massage.h
        massage2.f
        matbld0tri.f
        matbld1.f
        matbld2d_stor.f
        matbld3d_stor.f
        math.f
        math_integrate.f
        math_sum.f
        matrix_values_compress.c
        medianpts_lg.f
        mega2d.f
        mega3d.f
        mega3d_inner_loop.f
        mega_error.f
        mega_hessian.f
        memory.F
        mergelst.f
        mergepts_simplex.f
        metis.h
        metis_defs.h
        metis_interface.f
        metis_lg.c
        metis_macros.h
        metis_proto.h
        metis_rename.h
        metis_struct.h
        mflip.f
        mode_lg.f
        mregion.f
        msgtty.f
        multi_material.f
        multi_material2d_lg.f
        nbrsmooth.f
        nearestpoint.f
        nearestpoint0.f
        neibor.h
        neighbor_recolor_lg.f
        next_power_of_2.f
        nurbl.f
        nurbp.f
        nurbs.f
        occonv.f
        ocgrdedg.f
        ocgrid.f
        ocmatmul.f
        ocmatpd1.f
        ocmatpd2.f
        ocmidpt.f
        ocnulvec.f
        offsetpara.f
        offsetsurf.f
        orderll.f
        packsi.f
        partition.f
        pcc_test.f
        perturb_lg.f
        pgg.f
        pntlimc.f
        pntlimn.f
        point_to_plane_lg.f
        polyfun.f
        popcnt.f
        popcomponents_lg.f
        popcones_lg.f
        precondition.f
        primestep.f
        pset.F
        quad_quality.c
        quadxy.f
        quadxyz.f
        quality.f
        qualxmmn.f
        queue.f
        radapt.f
        ran2_lg.f
        rand_lg.f
        rankvolume.f
        ranpts_lg.f
        read_fehm_zone.f
        read_geometries_lg.f
        read_globals_lg.f
        read_gocad_tsurf.f
        read_lagrit.f
        read_lagrit_geom_old.f
        read_lagrit_old.f
        read_sheetij.f
        read_trilayers.f
        readavs.f
        readdatex.f
        readdcm.f
        readdump.f
        readfile.f
        readgmv_ascii.f
        readgmv_binary.f
        readngphex.f
        readngptet.f
        readngptri.f
        readnurbs_iges_grid.f
        readruby_lg.f
        readvrml.f
        recon.f
        recon2.f
        recon2d.f
        reconloop2d.f
        reconloop3d.f
        recvr20.f
        recvr23.f
        refine.f
        refine_cc_rivara.f
        refine_coupling_coef.f
        refine_edge.f
        refine_edge_2d.f
        refine_edge_3d.f
        refine_edge_add.f
        refine_edge_list_lg.f
        refine_face.f
        refine_face_add.f
        refine_fix_add.f
        refine_interface_elements_lg.f
        refine_spawn_lg.f
        refine_tet_add.f
        region.f
        regnpts.F
        regset.f
        remove_bigtet.f
        remove_bigtri_lg.f
        reorder.f
        resetpts.f
        retrieve_within_eps.f
        reverseform.f
        rm.f
        rmmat.f
        rmpoint.f
        rmregion.f
        rmsphere.f
        rmsurf.f
        rmtetless.f
        rotateln.f
        rotatelo.f
        rotatepr.f
        rotatept.f
        rz.f
        rzamr_lg.f
        rzbrick3.f
        rzbrickg.f
        rzbrickh.f
        rzs.f
        rzstrat.f
        rzv_lg.f
        sbinit.F
        scale_lg.f
        search.h
        select.f
        set_bit_type.f
        set_epsilon.f
        set_global.f
        set_info_i.f
        set_jtetoff.f
        set_user_bounds.f
        setarayp.f
        sethessian.f
        setsize.F
        sgd.f
        sheet.f
        shtgtsf.f
        shtgtsfp.f
        shttst.f
        shttstv.f
        skiplist.ch
        smooth.f
        smooth.h
        smooth_vconserve.f
        smooth_vconserve_triple.f
        solid_angle_lg.f
        solvsym3.f
        sortbins.f
        sparseMatrix.c
        sparseMatrix.h
        sparse_lg.f
        sphere1.f
        sphere2.f
        stack_fill.f
        stack_layers.f
        stack_options.f
        statementfunctions.h
        surfac.f
        surface.f
        surfpts.f
        surfset.f
        surftst.f
        surftstv.f
        synthnormal.f
        table_element.f
        tangent_plane.f
        taylor_error.f
        tempgable.f
        tempgeo.f
        tempkuprat.f
        temptam.f
        termcode.f
        termgen.f
        test2to3.f
        test4to4.f
        test_argument_type.f
        test_coupling_coef.f
        test_interior_mat_lg.f
        testdamage.f
        tettestd.f
        translate.f
        tree_to_fe.f
        triangulate_lg.f
        tritri.f
        try2to0.f
        try2to0b.f
        try2to2b.f
        try2to2r.f
        try2to3i.f
        try4to4x.f
        try4to4xv.f
        tst2to3i.f
        tstregv.f
        type_sizes.h
        ung2avs.f
        unpackpc.f
        unpacktp.f
        upscale.f
        user_sub.f
        verify_edges.f
        volume_element.f
        volume_hex.f
        volume_node.f
        volume_qud.f
        volume_tet.f
        volume_tri.f
        voravg2d.f
        vorfclst.f
        voron2d.f
        voronoi_center.f
        voronoi_stor.f
        vorpoint.f
        vorpts_lg.f
        writedump.f
        writfls.f
        writinit.f
        writloga.f
        writlogb.f
        writset.f
        x3d_error.f
        xinterpolate.f
        xsectelm.f
        xsumsp2r.f
        xsumspi.f
        xyznorm.f
        zq.f)
